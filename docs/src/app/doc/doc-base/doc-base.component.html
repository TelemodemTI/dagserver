<div class="page-wrapper">
    <!-- ******Header****** -->
    <header id="header" class="header">
        <div class="container">
            <div class="branding">
                <h1 class="logo">
                    <a href="index.html">
                        <span aria-hidden="true" class="icon_documents_alt icon"></span>
                        <span class="text-highlight">Dagserver</span><span class="text-bold">Documentation</span>
                    </a>
                </h1>
                
            </div><!--//branding-->
            
            <ol class="breadcrumb">
                <li class="breadcrumb-item"><a href="index.html">Home</a></li>
                <li class="breadcrumb-item active">Documentation</li>
            </ol>
            
            <div class="top-search-box">
                 <form class="form-inline search-form justify-content-center" action="" method="get">
            
                    <input type="text" placeholder="Search..." name="search" class="form-control search-input">
                    
                    <button type="submit" class="btn search-btn" value="Search"><i class="fas fa-search"></i></button>
                    
                </form>
            </div>
            
        </div><!--//container-->
    </header><!--//header-->
    <div class="doc-wrapper">
        <div class="container">
            <div id="doc-header" class="doc-header text-center">
                <h1 class="doc-title"><i class="icon fa fa-book"></i> Documentation</h1>
                <div class="meta"><i class="far fa-clock"></i> Last updated: 24 Sept 2023</div>
            </div><!--//doc-header-->
            <div class="doc-body row">
                <div class="doc-content col-md-9 col-12 order-1">
                    <div class="content-inner">
                        <section id="download-section" class="doc-section" tabindex="-1">
                            <h2 class="section-title">General</h2>
                            <div class="section-block">
                                <p>Dagserver enables the execution of DAG (Directed Acyclic Graph) flows in a decoupled manner within a Java environment. It supports a wide range of use cases, including data integration between repositories and the management of continuous integration workflows.</p>
                            </div>
                        </section><!--//doc-section-->
                        <section id="installation-section" class="doc-section" tabindex="-1">
                            <h2 class="section-title">Components</h2>
                            <div id="step1"  class="section-block">
                                <p>The following diagram illustrates the components within dagserver</p>
                                <img src="assets/components.drawio.png"/>
                            </div>
                        </section><!--//doc-section-->
                        <section id="channels-section" class="doc-section" tabindex="-1">
                            <h2 class="section-title">Channels</h2>
                            <div class="section-block">
                                <p>Channels are the means by which events are executed within the Dagserver scheduler, triggering the execution of a DAG that contains the business logic to be implemented.</p>
                                <p>Currently, there are four methods to initiate the execution of a DAG:</p>
                                <ol>
                                    <li>Activating an execution trigger: These triggers can be configured using cron/quartz statements, enabling scheduled executions with complex logic.</li>
                                    <li>Executing via the GraphQL endpoint: This method is utilized within the frontend application and allows for controlled execution of a specific DAG.</li>
                                    <li>Configuring a GitHub webhook: This approach enables the triggering of a DAG's execution based on push events to a specific repository.</li>
                                    <li>Using the RabbitMQ Channel: This channel allows events to be triggered by listening to queue events, providing another way to initiate DAG executions.</li>
                                </ol>
                            </div>
                        </section>
                        <section id="scheduler-section" class="doc-section" tabindex="-1">
                            <h2 class="section-title">Scheduler</h2>
                            <div class="section-block">
                                <p>The scheduler configuration is divided into the management of properties or parameters, and the information about the jobs that are executed within the scheduler.</p>
                                <ul>
                                    <li>
                                        <label>Scheduler View:</label>
                                        <p>The scheduler view is divided into two sections:</p>

                                        <ol>
                                        <li>
                                            <strong>Available JAR Files (Jobs):</strong>
                                            <p>In this section, you can find both external jobs, which are located in the respective path of the operating system, and internal jobs. The latter cannot be executed through this view as they are internal to the scheduler.</p>
                                            <p>Additionally, you have the ability to execute jobs from the frontend, view the respective DAG canvas along with its dependencies, stop jobs in the scheduler, and review execution logs.</p>
                                            <img src="assets/images/fig017.PNG" class="center etl"/>
                                        </li>

                                        <li>
                                            <strong>Job Designs:</strong>
                                            <p>Job designs are available to developers but are not compiled or accessible to the scheduler.</p>
                                            <img src="assets/images/fig018.PNG" class="center etl"/>
                                        </li>
                                        </ol>
                                        <div class="callout-block callout-success">
                                            <div class="icon-holder">
                                                <i class="fas fa-thumbs-up"></i>
                                            </div><!--//icon-holder-->
                                            <div class="content">
                                                <h4 class="callout-title">Useful Tip:</h4>
                                                <p>When the DAG is compiled it is impossible to add or change its design without compiling it again. But it is possible to change the value of the parameters configured in each node. This can be done directly from the compiled DAG detail</p>
                                            </div><!--//content-->
                                        </div>
                                        <img src="assets/images/fig019.PNG" class="center etl"/>
                                        <p>
                                        The dependencies viewer allows you to quickly identify the listener jobs that are listening to the execution of the DAG
                                        </p>
                                        <img src="assets/images/fig020.PNG" class="center etl"/>
                                        <p>The canvas enables you to configure each node and visualize how the operators are interconnected within the context of the designed DAG.</p>
                                        <img src="assets/images/fig021.PNG" class="center etl"/>
                                        <img src="assets/images/fig022.PNG" class="center etl"/>
                                        <p>In the 'Designs' tab, you can create a new DAG design using the canvas. This view also enables you to compile this design into an executable file that is visible to the scheduler. Additionally, you can export the job design to a JSON file, allowing you to later import and utilize this design.</p>
                                        <img src="assets/images/fig023.PNG" class="center etl"/>
                                        <img src="assets/images/fig024.PNG" class="center etl"/>
                                        <div class="callout-block callout-success">
                                            <div class="icon-holder">
                                                <i class="fas fa-thumbs-up"></i>
                                            </div><!--//icon-holder-->
                                            <div class="content">
                                                <h4 class="callout-title">Useful Tip:</h4>
                                                <p>The visual positions of each operator on the canvas are not saved within the generated classes. Instead, they are recalculated based on the DAG structure.</p>
                                            </div><!--//content-->
                                        </div>
                                        <img src="assets/images/fig025.PNG" class="center etl"/>
                                        <p>When creating a DAG, in the right-side panel, you have the option to configure whether the DAG will be executed based on a schedule (CRON QUARTZ) or if it will be triggered by the behavior of another DAG (Job Listener). This flexibility enables the implementation of complex workflows within the tool.</p>
                                        <img src="assets/images/fig026.PNG" class="center etl"/>
                                        <img src="assets/images/fig027.PNG" class="center etl"/>
                                        <p>Operators are node types that can be employed within a DAG. They provide a wide range of functionalities, including running database queries, executing SSH commands on a remote server, or running a JAR file with custom logic.</p>
                                        <img src="assets/images/fig028.PNG" class="center etl"/>
                                        <img src="assets/images/fig029.PNG" class="center etl"/>
                                        <p>In the DAG editor canvas, each node can be customized to execute a specific operator. The configuration view enables you to set optional parameters, define scripts, and specify the particulars of each operator. Additionally, it allows you to test the DAG's functionality during the design phase.</p>
                                        <img src="assets/images/fig030.PNG" class="center etl"/>
                                        <p>The 'scripts' tab is available within operators that allow you to input additional scripts, such as SSH commands or SQL queries.</p>
                                        <img src="assets/images/fig031.PNG" class="center etl"/>
                                        <p>In the 'settings' tab, you can configure the name of the stage on the canvas and modify the state of the input link of the DAG node.</p>
                                        <img src="assets/images/fig032.PNG" class="center etl"/>
                                    </li>
                                    <li>
                                        <label>Properties View:</label>
                                        <p>The properties view allows you to access the property groups created within the scheduler. These property groups correspond to the job parameters configured in the DAG designer.</p>
                                        <img src="assets/images/fig032.PNG" class="center etl"/>
                                        <p>Within this view, you can view, edit, and delete the parameters managed within the DAG server. Additionally, you have the option to export and import these parameters using JSON files.</p>
                                    </li>
                                </ul>
                            </div>
                        </section>
                        <section id="admin-section" class="doc-section" tabindex="-1">
                            <h2 class="section-title">Administration</h2>
                            <div class="section-block">

                            </div>
                        </section>
                        <section id="basic-section" class="doc-section" tabindex="-1">
                            <h2 class="section-title">Basic Usage</h2>
                            <div class="section-block">

                            </div>
                        </section>
                        <section id="etl-section" class="doc-section" tabindex="-1">
                            <h2 class="section-title">ETL Example</h2>
                            <div class="section-block">
                                <p>In the following example, we will illustrate a typical ETL (Extract, Transform, Load) process for loading records. The process design is as follows:</p>
                                <img src="assets/etl-example.drawio.png" class="center etl"/>
                                <br>
                                <p>To read the file, we will utilize the File Operator with the following configuration:</p>
                                <img src="assets/images/fig004.PNG" class="center etl"/>
                                <br>

                                <p>The next step is to configure the JDBC Operator to establish a connection with the relevant database. In this example, we will connect to MySQL. To do this, ensure that you have the corresponding driver JAR file accessible from Dagserver.</p>
                                <p>The configuration for this example is as follows:</p>
                                <img src="assets/images/fig005.PNG" class="center etl"/>
                                <img src="assets/images/fig006.PNG" class="center etl"/>
                                <br>
                                <p>The third step in the flow involves identifying new records. To accomplish this, we'll use a script configured with the Groovy Operator:</p>
                                <img src="assets/images/fig008.PNG" class="center etl"/>
                                <p>In the fourth step, we'll insert these new records into the database:</p>
                                <img src="assets/images/fig009.PNG" class="center etl"/>
                                <img src="assets/images/fig016.PNG" class="center etl"/>
                                <p>The next step is to run another Groovy script to obtain the updated records:</p>
                                <img src="assets/images/fig010.PNG" class="center etl"/>
                                <p>Subsequently, we'll perform an update query to modify the records in the database:</p>
                                <img src="assets/images/fig011.PNG" class="center etl"/>
                                <img src="assets/images/fig012.PNG" class="center etl"/>
                                <p>Finally, using the Mail SMTP Operator, we can configure an email notification to be sent at the end of the flow execution:</p>
                                <img src="assets/images/fig013.PNG" class="center etl"/>
                                <p>The DAG canvas will resemble the following image:</p>
                                <img src="assets/images/fig007.PNG" class="center etl"/>
                                <p>To execute the example DAG, save and compile it, and you can initiate it directly from the frontend:</p>
                                <img src="assets/images/fig014.PNG" class="center etl"/>
                                <p>The log details will display the steps taken during the execution of the DAG, along with variables and data used:</p>
                                <img src="assets/images/fig015.PNG" class="center etl"/>
                            </div>
                        </section>
                        <section id="http-section" class="doc-section" tabindex="-1">
                            <h2 class="section-title">HTTP Example</h2>
                            <div class="section-block">
                                <p>In the following example, we will demonstrate the process of uploading a JSON file from GitHub using various transfer protocols.</p>
                                <div class="callout-block callout-success">
                                    <div class="icon-holder">
                                        <i class="fas fa-thumbs-up"></i>
                                    </div><!--//icon-holder-->
                                    <div class="content">
                                        <h4 class="callout-title">Useful Tip:</h4>
                                        <p>For example purposes, the following JSON file will be used https://gist.githubusercontent.com/ksafranski/2973986/raw/5fda5e87189b066e11c1bf80bbfbecb556cf2cc1/Common-Currency.json.</p>
                                    </div><!--//content-->
                                </div>
                                <p>
                                    We will create the following canvas design:
                                </p>
                                <img src="assets/images/fig034.PNG" class="center etl"/>
                                
                                <p>
                                    The first step involves configuring an HTTP Operator to make a GET request:
                                </p>
                                <img src="assets/images/fig035.PNG" class="center etl"/>
                                
                                <p>
                                    Next, we will use a Groovy script to extract the fields needed for creating the CSV file:
                                </p>
                                <img src="assets/images/fig036.PNG" class="center etl"/>
                                
                                <p>
                                    Using the extracted data, we will build the file that will be sent via FTP:
                                </p>
                                <img src="assets/images/fig037.PNG" class="center etl"/>
                                
                                <p>
                                    Finally, we will perform the transfer using the FTP Operator, with the following configuration:
                                </p>
                                <img src="assets/images/fig038.PNG" class="center etl"/>
                                
                                <p>
                                    The FTP Operator provides three functionalities for this protocol, and we will use the upload command.
                                </p>
                                <div class="callout-block callout-success">
                                    <div class="icon-holder">
                                        <i class="fas fa-thumbs-up"></i>
                                    </div><!--//icon-holder-->
                                    <div class="content">
                                        <h4 class="callout-title">Useful Tip:</h4>
                                        <p>The methods exposed by the FTPOperator are the following:</p>
                                        <ul>
                                            <li>list pathremote</li>
			                                <li>download remote local</li>
			                                <li>upload remote local</li>
                                        </ul>
                                    </div><!--//content-->
                                </div>
                            </div>
                        </section>
                        <section id="custom-jar-section" class="doc-section" tabindex="-1">
                            <h2 class="section-title">Execute custom Jar file</h2>
                            <div class="section-block">
                                In this example, you will learn how to execute a custom JAR (Java Archive) file within the context of your DAG (Directed Acyclic Graph) workflow. This can be useful when you need to integrate custom Java-based functionality into your workflow.
                                <div class="callout-block callout-success">
                                    <div class="icon-holder">
                                        <i class="fas fa-thumbs-up"></i>
                                    </div><!--//icon-holder-->
                                    <div class="content">
                                        <h4 class="callout-title">Useful Tip:</h4>
                                        <p>Before you proceed, make sure you have the following prerequisites in place:</p>
                                        <ul>
                                            <li>Custom JAR File: You should have the custom JAR file that contains your Java code or application logic.</li>
			                                <li>Access Permissions: Ensure that the DAGserver has the necessary permissions to access and execute the JAR file.</li>
                                        </ul>
                                    </div><!--//content-->
                                </div>
                                <p>To execute a custom JAR file within the designer, follow these steps:</p>
                                <p>Within the designer, add the JavaOperator.</p>
                                <img src="assets/images/fig041.PNG" class="center etl"/>
                                <p>Configure the following two parameters in the JavaOperator's parameter modal:</p>
                                <img src="assets/images/fig040.PNG" class="center etl"/>
                                <p>jarPath: This parameter specifies the path that will be used to create the ClassLoader. Ensure that the JAR file you want to execute is located within this path.</p>
                                <p>className: This parameter indicates the class to be executed from the JAR file. The class to be executed must meet the following requirements:</p>
                                <ul>
                                    <li>It must implement the Serializable interface.</li>
                                    <li>It must implement the Callable interface, where T is the type of object that the callable class should return.</li>
                                    <li>The callable class should have access to the xcom variables and the arguments (which contain the two aforementioned variables).</li>        
                                </ul>
                            </div>
                        </section>
                        <section id="test-Ng-section" class="doc-section" tabindex="-1">
                            <h2 class="section-title">Execute TestNG Test Suite</h2>
                            <div class="section-block">
                                <p>In the following example we will review how it is possible to execute a test suite, using the testNG testing framework and the TestNGOperator operator.</p>
                                <p>First, add the TestNGOperator operator to the design canvas of a DAG</p>
                                <img src="assets/images/fig044.PNG" class="center etl"/>
                                <p>The operator allows us to configure the following:</p>
                                <img src="assets/images/fig043.PNG" class="center etl"/>
                                <ul>
                                    <li>Jar File Path: Specify the path where the corresponding JAR files will be located.</li>
                                    <li>XML Files: Input the XML files containing the respective test suites to be executed.</li>
                                    <li>Report Output Path: Define the output path for the report generated by the TestNG framework.</li>
                                </ul>
                            </div>
                        </section>
                        <section id="chat-gpt-section" class="doc-section" tabindex="-1">
                            <h2 class="section-title">Mail templating and Chat GPT</h2>
                            <div class="section-block">
                                    <p>In this example, the ChatGPTOperator will be used, by sending a prompt, it will generate content that will later be taken by the Mail Operator stage</p>
                                    <div class="callout-block callout-success">
                                        <div class="icon-holder">
                                            <i class="fas fa-thumbs-up"></i>
                                        </div><!--//icon-holder-->
                                        <div class="content">
                                            <h4 class="callout-title">Useful Tip:</h4>
                                            <p>To use the ChatGPT Operator you must have paid access to the GPT chat API.</p>
                                        </div><!--//content-->
                                    </div>
                                    
                                    <p>The design of the Job is shown in the following image:</p>
                                    <img src="assets/images/fig045.PNG" class="center etl"/>
                                    <p>To configure the ChatGPTOperator, you must provide the respective api-key, and in the 'script' tab we can add the respective prompt.</p>
                                    <img src="assets/images/fig046.PNG" class="center etl"/>
                                    <p>Then in the configuration of the Mail Operator, an xcom must be configured, with the name of the ChatGPTOperator stage in the canvas, in this way the Mail Operator will take as body, the output of the chatGpt operator</p>
                                    <img src="assets/images/fig047.PNG" class="center etl"/>
                            </div>
                        </section>
                        <section id="mongodb-section" class="doc-section" tabindex="-1">
                            <h2 class="section-title">Read collection from mongo db</h2>
                            <div class="section-block">
                                <p>To read a collection from mongo db, the first thing will be to draw the following DAG on the canvas:</p>
                                <img src="assets/images/fig048.PNG" class="center etl"/>
                                <p>The mongo operator configuration is shown in the following image:</p>
                                <img src="assets/images/fig049.PNG" class="center etl"/>
                                <p>the configuration of the Groovy stage, which in this case, will be used to convert the data types to String.</p>
                                <img src="assets/images/fig050.PNG" class="center etl"/>
                                <p>The configuration of the same operator, but with writing mode, is shown in the following image</p>
                                <img src="assets/images/fig051.PNG" class="center etl"/>
                                <p>There are also options to perform upsert and delete, but a json must be defined with the respective filter.</p>
                            </div>
                        </section>
                    </div><!--//content-inner-->
                </div><!--//doc-content-->
                <div class="doc-sidebar col-md-3 col-12 order-0 d-none d-md-flex">
                    <div id="doc-nav" class="doc-nav">
                            <nav id="doc-menu" class="nav doc-menu flex-column sticky">
                                <li class="nav-item">
                                    <a class="nav-link scrollto pointer" (click)="goTo('download-section')">General</a>
                                </li>
                                <li class="nav-item">
                                    <a class="nav-link scrollto pointer"  (click)="goTo('installation-section')">Components
                                    </a>
                                </li>
                                <li class="nav-item">
                                    <a class="nav-link scrollto pointer" (click)="goTo('channels-section')">Channels
                                    </a>
                                </li>
                                <li class="nav-item">
                                    <a class="nav-link scrollto pointer" (click)="goTo('scheduler-section')">Scheduler
                                    </a>
                                </li>
                                <li class="nav-item">
                                    <a class="nav-link scrollto pointer" (click)="goTo('admin-section')">Admin
                                    </a>
                                </li>

                                <nav class="nav doc-sub-menu nav flex-column">
                                    <li class="nav-item">
                                        <a class="nav-link scrollto pointer" (click)="goTo('basic-section')">Basic Usage</a>
                                    </li>
                                    <li class="nav-item">
                                        <a class="nav-link scrollto pointer" (click)="goTo('etl-section')">ETL Example</a>
                                    </li>
                                    <li class="nav-item">
                                        <a class="nav-link scrollto pointer" (click)="goTo('http-section')">Http and File Storage example</a>
                                    </li>
                                    <li class="nav-item">
                                        <a class="nav-link scrollto pointer" (click)="goTo('custom-jar-section')">Execute custom Jar file</a>
                                    </li>
                                    <li class="nav-item">
                                        <a class="nav-link scrollto pointer" (click)="goTo('test-Ng-section')">Execute TestNG Test Suite</a>
                                    </li>
                                    <li class="nav-item">
                                        <a class="nav-link scrollto pointer" (click)="goTo('chat-gpt-section')">Mail templating and Chat GPT</a>
                                    </li>
                                    <li class="nav-item">
                                        <a class="nav-link scrollto pointer" (click)="goTo('mongodb-section')">MongoDB Example</a>
                                    </li>
                                    <li class="nav-item">
                                        <a class="nav-link scrollto pointer">Publish and Consume RabbitMQ</a>
                                    </li>
                                    <li class="nav-item">
                                        <a class="nav-link scrollto pointer">Publish and Consume Redis</a>
                                    </li>
                                    <li class="nav-item">
                                        <a class="nav-link scrollto pointer">Windows CMD example</a>
                                    </li>
                                </nav><!--//nav-->
                                
                                
                            </nav><!--//doc-menu-->
                        
                    </div>
                </div><!--//doc-sidebar-->
            </div><!--//doc-body-->              
        </div><!--//container-->
    </div><!--//doc-wrapper-->
    
    
    
</div><!--//page-wrapper-->

<footer class="footer text-center">
    <div class="container">
        <small class="copyright">docs by <a href="https://www.telemodem.cl/" target="_blank">Telemodem</a></small>
    </div><!--//container-->
</footer><!--//footer-->